<!DOCTYPE html>
<html>
  <head>
    <title>DEMO</title>
  </head>
  <body>
    <div id="container"> 
    </div>
    
    <script>
    console.log('*******************************')
    /*
      概念:
      CSRF: Cross-Site request forgery 跨站请求伪造攻击
      攻击者诱导用户进入一个第三方网站,然后该网站向攻击网站发送跨站请求.
      如果用户在被攻击网站中保存了登录状态,那么攻击者就可以利用这个登录状态,绕过后台的用户的验证,冒充用户向服务器执行一些操作.

      攻击类型
      GET类型的CSRF攻击,比如在网站中的一个img标签里构建一个请求,当用户打开这个网站会自动发起提交;
      POST类型的CSRF攻击,比如构建一个表单,然后隐藏它,当用户进入页面时,自动提交这个表单;
      链接类型的CSRF攻击,比如在a标签的href属性里构建一个请求,然后诱导用户去点击;

      **CSRF攻击攻击原理及过程如下：**

      1、用户C打开浏览器，访问受信任网站A，输入用户名和密码请求登录网站A；
      2、在用户信息通过验证后，网站A产生Cookie信息并返回给浏览器，此时用户登录网站A成功，可以正常发送请求到网站A；
      3、用户未退出网站A之前，在同一浏览器中，打开一个TAB页访问网站B；
      4、网站B接收到用户请求后，返回一些攻击性代码，并发出一个请求要求访问第三方站点A；
      5、浏览器在接收到这些攻击性代码后，根据网站B的请求，在用户不知情的情况下携带Cookie信息，向网站A发出请求。
         网站A并不知道该请求其实是由B发起的，所以会根据用户C的Cookie信息以C的权限处理该请求，导致来自网站B的恶意代码被执行。 

      （1）验证 HTTP Referer 字段，利用 HTTP 头中的 Referer 判断请求来源是否合法，Referer记录了该 HTTP 请求的来源地址。
        > 优点：简单易行，只需要在最后给所有安全敏感的请求统一增加一个拦截器来检查 Referer 的值就可以。特别是对于当前现有的系统，
          不需要改变当前系统的任何已有代码和逻辑，没有风险，非常便捷。
        > 缺点：Referer 的值是由浏览器提供的，不可全信，低版本浏览器下Referer存在伪造风险。
          用户自己可以设置浏览器使其在发送请求时不再提供 Referer时，网站将拒绝合法用户的访问。

      （2）在请求地址中添加 token 并验证。CSRF 攻击之所以能够成功，是因为黑客可以完全伪造用户的请求，
        该请求中所有的用户验证信息都是存在于 cookie 中，因此黑客可以在不知道这些验证信息的情况下直接利用用户自己的 cookie 来通过安全验证。
        要抵御CSRF，关键在于在请求中放入黑客所不能伪造的信息，并且该信息不存在于cookie之中。
        可以在 HTTP 请求中以参数的形式加入一个随机产生的 token，并在服务器端建立一个拦截器来验证这个 token，
        如果请求中没有token或者token 内容不正确，则认为可能是CSRF攻击而拒绝该请求。

        > 优点：这种方法要比检查 Referer 要安全一些，token 可以在用户登陆后产生并放于 session 之中，然后在每次请求时把 token 从 session 中拿出，与请求中的 token 进行比对。
        > 缺点：对所有请求都添加 token 比较困难。难以保证 token 本身的安全，依然会被利用获取到 token。

      （3）在 HTTP 头中自定义属性并验证
          这种方法也是使用 token 并进行验证，和上一种方法不同的是，这里并不是把token以参数的形式置于 HTTP 请求之中，
          而是把它放到 HTTP 头中自定义的属性里。通过 XMLHttpRequest 这个类，
          可以一次性给所有该类请求加上 csrftoken 这个 HTTP 头属性，并把 token值放入其中。
          这样解决了上种方法在请求中加入 token 的不便，同时，通过 XMLHttpRequest 请求的地址不会被记录到浏览器的地址栏，
          也不用担心token会透过Referer泄露到其他网站中去。

        > 优点：统一管理token 输入输出，可以保证token的安全性。
        > 缺点：有局限性，无法在非异步的请求上实施。

    */ 
    </script>
  </body>
</html>
